{"version":3,"file":"0-D-iRsZTo.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/_layout.server.ts.js","../../../.svelte-kit/adapter-node/nodes/0.js"],"sourcesContent":["import { g as getSession } from \"../../chunks/auth.js\";\nimport { d as db } from \"../../chunks/database.js\";\nconst load = async ({ cookies }) => {\n  const sessionId = cookies.get(\"sessionId\");\n  const session = sessionId ? getSession(sessionId) : null;\n  let user = null;\n  let sessionForFrontend = null;\n  if (session && session.userId) {\n    try {\n      const userDbData = db.prepare(\n        \"SELECT id, username, profile_image, role FROM users WHERE id = ?\"\n      ).get(session.userId);\n      if (userDbData) {\n        user = {\n          id: userDbData.id,\n          username: userDbData.username,\n          profileImage: userDbData.profile_image,\n          // Map from snake_case to camelCase\n          role: userDbData.role\n        };\n        sessionForFrontend = {\n          // Populate session data for frontend\n          userId: session.userId,\n          role: userDbData.role\n          // Using role from fetched user data for consistency\n        };\n      }\n    } catch (error) {\n      console.error(\"Error fetching user in layout.server.ts:\", error);\n    }\n  }\n  return {\n    // This 'user' object will be available as `data.user` in +layout.svelte and `(await parent()).user` in child loads\n    user,\n    // This 'session' object is now explicitly returned, making it available via `(await parent()).session`\n    session: sessionForFrontend\n    // Make sure to return this\n  };\n};\nexport {\n  load\n};\n","import * as server from '../entries/pages/_layout.server.ts.js';\n\nexport const index = 0;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/_layout.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/+layout.server.ts\";\nexport const imports = [\"_app/immutable/nodes/0.DZqdPu5X.js\",\"_app/immutable/chunks/Do_-mL-j.js\",\"_app/immutable/chunks/CSgM7ggg.js\",\"_app/immutable/chunks/DFkGWr6I.js\",\"_app/immutable/chunks/CFJF3e64.js\",\"_app/immutable/chunks/B3Q4MtaZ.js\",\"_app/immutable/chunks/DiJvn89z.js\",\"_app/immutable/chunks/BAYIV7lD.js\",\"_app/immutable/chunks/BveS6AeT.js\",\"_app/immutable/chunks/eOTtUvit.js\",\"_app/immutable/chunks/Ca16gRfA.js\",\"_app/immutable/chunks/Cc2sBIKg.js\",\"_app/immutable/chunks/BxwOPTHF.js\",\"_app/immutable/chunks/DTVKcNaw.js\",\"_app/immutable/chunks/D5BR4JST.js\",\"_app/immutable/chunks/CRDaTebH.js\",\"_app/immutable/chunks/DLjW1ahz.js\",\"_app/immutable/chunks/BAa4oyvZ.js\",\"_app/immutable/chunks/Bi5o8etP.js\",\"_app/immutable/chunks/EdVlTvtb.js\"];\nexport const stylesheets = [\"_app/immutable/assets/0.Cbs7W5_h.css\"];\nexport const fonts = [];\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,MAAM,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC;AAC5C,EAAE,MAAM,OAAO,GAAG,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,GAAG,IAAI;AAC1D,EAAE,IAAI,IAAI,GAAG,IAAI;AACjB,EAAE,IAAI,kBAAkB,GAAG,IAAI;AAC/B,EAAE,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,EAAE;AACjC,IAAI,IAAI;AACR,MAAM,MAAM,UAAU,GAAG,EAAE,CAAC,OAAO;AACnC,QAAQ;AACR,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC;AAC3B,MAAM,IAAI,UAAU,EAAE;AACtB,QAAQ,IAAI,GAAG;AACf,UAAU,EAAE,EAAE,UAAU,CAAC,EAAE;AAC3B,UAAU,QAAQ,EAAE,UAAU,CAAC,QAAQ;AACvC,UAAU,YAAY,EAAE,UAAU,CAAC,aAAa;AAChD;AACA,UAAU,IAAI,EAAE,UAAU,CAAC;AAC3B,SAAS;AACT,QAAQ,kBAAkB,GAAG;AAC7B;AACA,UAAU,MAAM,EAAE,OAAO,CAAC,MAAM;AAChC,UAAU,IAAI,EAAE,UAAU,CAAC;AAC3B;AACA,SAAS;AACT;AACA,KAAK,CAAC,OAAO,KAAK,EAAE;AACpB,MAAM,OAAO,CAAC,KAAK,CAAC,0CAA0C,EAAE,KAAK,CAAC;AACtE;AACA;AACA,EAAE,OAAO;AACT;AACA,IAAI,IAAI;AACR;AACA,IAAI,OAAO,EAAE;AACb;AACA,GAAG;AACH,CAAC;;;;;;;ACpCW,MAAC,KAAK,GAAG;AACrB,IAAI,eAAe;AACP,MAAC,SAAS,GAAG,YAAY,eAAe,KAAK,CAAC,MAAM,OAAO,8BAAoC,CAAC,EAAE;AAElG,MAAC,SAAS,GAAG;AACb,MAAC,OAAO,GAAG,CAAC,oCAAoC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC,CAAC,mCAAmC;AAC5tB,MAAC,WAAW,GAAG,CAAC,sCAAsC;AACtD,MAAC,KAAK,GAAG;;;;"}